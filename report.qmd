---
title: "Revenue and Expenses: Men's vs. Women's Basketball"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

```{r}
#| label: load-pkgs

library(tidyverse)
library(tidymodels)
```

```{r}
#| label: data

basketball <- read.csv("data/ACC_Basketball_2020_2021.csv")
```

## Introduction and data

**Research question:** How do men's college basketball revenues and expenses compare to women's college basketball revenues and expenses?

To-do's: review/polish, added background, and cite sources with footnote and link at bottom, only 1 data set needed

This data came from Equity in Athletics Data Analysis (EADA). It was collected through mandatory reports from post-secondary institutions that receive Title IX funding. The data was collected from 2020 and 2021. The data is looking as equity in college athletics by comparing different aspects of male and female sports. This specific dataset is looking at all schools in the Atlantic Coast Conference. Data was collected on multiple variables including the number of male and female athletes, the number of male and female coaches, and the revenue of male and female sports. There is also information on coaching salaries. There are no ethical concerns we foresee arising.

https://globalsportmatters.com/business/2022/03/11/for-the-ncaa-building-the-business-of-womens-sports-starts-with-basketball/#:\~:text=Similarly%2C%20Division%20I%20men's%20basketball,than%20%24600%20million%20in%20revenue.

https://www.wsn.com/ncaam-basketball/ncaa-men-vs-women-basketball/

https://www.npr.org/2021/10/27/1049530975/ncaa-spends-more-on-mens-sports-report-reveals

## Methodology

**Note: don't use co-ed, the four variables looked at are "Revenues.Men.s.Team" vs "Revenues.Women.s.Team" and "Expenses.Men.s.Team" vs "Expenses.Women.s.Team"**

1\) summary statistics: calculating average between 2020 and 2021 for each school in each metric (i.e., mens vs. women's revenue and expenses, so 4 metrics: mens average revenue, mens average expenses, womens average revenue, and womens average expenses)

**Then using those averages, calculate average difference between men's and women's revenues, then average difference between men's and women's expenses**

```{r}
#| label: calculate-2020-2021-averages

mens_bball_sum_stats <- basketball |>
  group_by(Institution.Name) |>
  summarise(avg_rev_men = mean(Revenues.Men.s.Team), 
            avg_exp_men = mean(Expenses.Men.s.Team)) 

womens_bball_sum_stats <- basketball |>
  group_by(Institution.Name) |>
  summarise(avg_rev_women = mean(Revenues.Women.s.Team),
            avg_exp_women = mean(Expenses.Women.s.Team)) 

bball_sum_stats <- mens_bball_sum_stats |>
  full_join(womens_bball_sum_stats) |>
  mutate(rev_diff = avg_rev_men - avg_rev_women) |>
  mutate(exp_diff = avg_exp_men - avg_exp_women) |>
  mutate(rev_diff = as.factor(rev_diff)) |>
  mutate(exp_diff = as.factor(exp_diff))

```

2\) Visualizations: bar graph of men's revenue and expenses vs women's revenue and expenses faceted by school using averages from calculated summary statistics; bar graph of men's vs women's revenues, then men's vs. women's expenses, faceted by school, using averages calculated above again

```{r}
bball_sum_stats 
```

```{r}
#| label: school-up-values 

pivoted_rev <- bball_sum_stats |>
pivot_longer(
cols = c("avg_rev_men","avg_rev_women"),
names_to = "gender_rev",
values_to = c("revenue"))

pivoted_exp <- bball_sum_stats |>
pivot_longer(
cols = c("avg_exp_men","avg_exp_women"),
names_to = "gender_exp",
values_to = c("expense"))

pivoted_vs <- bball_sum_stats |>
pivot_longer(
cols = c("rev_diff","exp_diff"),
names_to = "ref_vs_diff",
values_to = c("amount"))
```

```{r}
#| label: school-revenue

plot_rev <- ggplot(pivoted_rev, aes(Institution.Name, revenue, fill=gender_rev))
plot_rev + geom_bar(stat = "identity", position = 'dodge') +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  labs(x = "University",
       y = "Revenue in $",
       title = "Average Revenue in the ACC for 
Men's vs Women's Basketball in 2020-2021") +
  scale_fill_discrete(name = "Gender", labels = c("Men", "Women")) +
  scale_y_continuous(labels = scales::comma)
  

```

```{r}
#| label: school-expenses

plot_exp <- ggplot(pivoted_exp, aes(Institution.Name, expense, fill=gender_exp))
plot_exp + geom_bar(stat = "identity", position = 'dodge') +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  labs(x = "University",
       y = "Expenses in $",
       title = "Average Expenses in the ACC for 
Men's vs Women's Basketball in 2020-2021") +
  scale_fill_discrete(name = "Gender", labels = c("Men", "Women")) +
  scale_y_continuous(labels = scales::comma)
```

```{r}
#| label: diff-expense-revenue

plot_vs <- ggplot(pivoted_vs, aes(Institution.Name, amount, fill=ref_vs_diff))
plot_vs + geom_bar(stat = "identity", position = 'dodge') +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  labs(x = "University",
       y = "Amount in $",
       title = "Difference in Average Revenues and Expenses in the ACC for 
Men's vs Women's Basketball in 2020-2021") +
  scale_fill_discrete(name = "Gender", labels = c("Men", "Women"))
```

**3) Justify the choice of statistical method(s) used to answer your research question**

In answering our research question of "How do men's college basketball revenues and expenses compare to women's college basketball revenues and expenses?" we first narrowed down the data to ACC schools as that would keep the distribution of the data used more uniform and limit the confounding variables. The objective of the study is to display the differences between women's and men's basketball in funding and revenue output, so in doing that we believed creating a bar graph would allow the audience to visualize the size of the difference (double or even triple). Furthermore, grouping the data by each college in the ACC is very important because every program has different user bases and revenue streams so the viewer can take into account the colleges marketing. For example, Duke basketball generates a ton of revenue from their brand as they recruit the top high school recruits, giving the viewer a context of why Duke's difference between men's and women's is larger than the rest of the ACC. Lastly, we focused on mean data rather than median data as we compared the average expenses and revenues of college programs during the 2020 and 2021 year as it is a more accurate measure of comparison.

## Results

Overview of Graphs:

From analyzing the bar graphs we can notice when looking at Average Revenue in the ACC for Men's vs Women's Basketball in 2020-2021, the men's programs in every ACC college produce more revenue. At Duke, the men's program produced over \$30 million in revenue while the women's program produces less than \$5 million. Every college in the ACC has their men's basketball program producing over double of their women's team except University of Miami and Clemson University. We are able to infer that Men's basketball programs in the ACC produce more than women's by a high margin. Boston college, NC state, and Syracuse Women's basketball programs produce less than \$2 million.

To look at the second part of the question we have to look at the bar graph for men's and women's programs expenses. We can see that the expenses for all men's basketball programs are higher than women's. However, only Duke, Syracuse, and Louisville men's programs have expenses that are more than double than the women's programs. The expenses for all the women's teams are also higher than the revenues. For example, Unc chapel hill's women's team generated roughly \$1 million in revenue in 2020-2021, but had roughly \$5 million in expenses that year. The Duke men's program had the highest expenses at almost \$20 million, but still produced over \$30 million in revenue so they were still profitable.

To more effectively answer our research question we created a hypothesis test to analyze both program's revenue:

Null Hypothesis:

The true mean revenue of ACC men's basketball programs is equal to the true mean revenue of ACC woman's basketball programs.

$H_0 : \mu_m - \mu_w = 0$

Alternative hypothesis:

The true mean revenue of ACC men's basketball programs is greater than the true mean revenue of ACC woman's basketball programs.

$H_1 : \mu_m - \mu_w > 0$

The defined variables are:

$\mu_m$ = true mean revenue of ACC men's basketball programs

$\mu_w$ = true mean revenue of ACC woman's basketball programs

```{r}
#| label: calculating-the-obs-stat

mens_mean_revenue <- bball_sum_stats |>
  summarize(mean(avg_rev_men))

womens_mean_revenue <- bball_sum_stats |>
  summarize(mean(avg_rev_women))

(mens_mean_revenue + womens_mean_revenue)/2

obs_stat = mens_mean_revenue - womens_mean_revenue

obs_stat

```

We can see that the observed statistic is 12212932.

```{r}
#| more-simple-data-frame

rev_data <- bball_sum_stats|>
  select(Institution.Name, avg_rev_men, avg_rev_women) |>
  pivot_longer(!Institution.Name, names_to = "gender", values_to = "rev")
```

```{r}
#| calculating-the-p-value
  
revenue_comparison = c("avg_rev_men", "avg_rev_women")

rev_data |>
  group_by(gender) |>
  summarize(mean(rev))

null_dist <- rev_data |>
  specify(response = rev, explanatory = gender) |>
  hypothesize(null = "independence") |>
  generate(reps = 5000, type = "permute") |>
  calculate(stat = "diff in means", order = c("avg_rev_men", "avg_rev_women"))


null_dist |>
  get_p_value(obs_stat, direction = "right")

```

From this calculation we can see that the p-value is 0 which means there is a 0 percent chance of the null hypothesis being rejected when it is true. A rule of thumb is that when the p-value is less than 0.05 we can reject the null hypothesis. Thus, we can reject the null hypothesis and accept the alternate hypothesis that the true mean revenue of ACC men's basketball programs is greater than the true mean revenue of ACC woman's basketball programs.

We alsocreated a hypothesis test to analyze both program's expenses:

Null Hypothesis:

The true mean expenses of ACC men's basketball programs is equal to the true mean revenue of ACC woman's basketball programs.

$H_0 : \mu_m - \mu_w = 0$

Alternative hypothesis:

The true mean expenses of ACC men's basketball programs is greater than the true mean revenue of ACC woman's basketball programs.

$H_1 : \mu_m - \mu_w > 0$

The defined variables are:

$\mu_m$ = true mean expenses of ACC men's basketball programs

$\mu_w$ = true mean expenses of ACC woman's basketball programs

```{r}
#| label: calculating-the-obs-stat

mens_mean_expenses <- bball_sum_stats |>
  summarize(mean(avg_exp_men))

womens_mean_expenses <- bball_sum_stats |>
  summarize(mean(avg_exp_women))

(mens_mean_expenses + womens_mean_expenses)/2

obs_stat = mens_mean_expenses - womens_mean_expenses

obs_stat
```

```{r}
#| more-simple-data-frame

exp_data <- bball_sum_stats|>
  select(Institution.Name, avg_exp_men, avg_exp_women) |>
  pivot_longer(!Institution.Name, names_to = "gender", values_to = "exp")
```

```{r}
#| calculating-the-p-value
  
revenue_comparison = c("avg_exp_men", "avg_exp_women")

exp_data |>
  group_by(gender) |>
  summarize(mean(exp))

null_dist <- exp_data |>
  specify(response = exp, explanatory = gender) |>
  hypothesize(null = "independence") |>
  generate(reps = 5000, type = "permute") |>
  calculate(stat = "diff in means", order = c("avg_exp_men", "avg_exp_women"))


null_dist |>
  get_p_value(obs_stat, direction = "right")

```

From this calculation we can see that the p-value is 0 which means there is a 0 percent chance of the null hypothesis being rejected when it is true. A rule of thumb is that when the p-value is less than 0.05 we can reject the null hypothesis. Thus, we can reject the null hypothesis and accept the alternate hypothesis that the true mean expenses of ACC men's basketball programs is greater than the true mean expenses of ACC woman's basketball programs.
